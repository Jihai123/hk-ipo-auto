<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¸¯è‚¡æ–°è‚¡è‡ªåŠ¨æ‰“åˆ†å™¨</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      min-height: 100vh;
      color: #fff;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 20px;
    }
    
    /* æ ‡é¢˜ */
    .header {
      text-align: center;
      margin-bottom: 40px;
    }
    
    .header h1 {
      font-size: 42px;
      font-weight: 800;
      background: linear-gradient(135deg, #e94560 0%, #ff6b6b 50%, #feca57 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 12px;
      letter-spacing: 2px;
    }
    
    .header p {
      color: #8892b0;
      font-size: 16px;
    }
    
    .header .badge {
      display: inline-block;
      background: linear-gradient(135deg, #2ed573, #7bed9f);
      color: #000;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      margin-top: 12px;
    }
    
    /* æœç´¢åŒºåŸŸ */
    .search-box {
      background: rgba(255,255,255,0.05);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 24px;
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    .search-form {
      display: flex;
      gap: 16px;
      align-items: flex-end;
      flex-wrap: wrap;
    }
    
    .form-group {
      flex: 1;
      min-width: 200px;
    }
    
    .form-group label {
      display: block;
      color: #ccd6f6;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
    }
    
    .form-group input {
      width: 100%;
      padding: 14px 18px;
      font-size: 18px;
      font-weight: 600;
      border: 2px solid rgba(233, 69, 96, 0.3);
      border-radius: 12px;
      background: rgba(0,0,0,0.3);
      color: #fff;
      outline: none;
      transition: all 0.3s ease;
    }
    
    .form-group input:focus {
      border-color: #e94560;
      box-shadow: 0 0 0 3px rgba(233, 69, 96, 0.2);
    }
    
    .form-group input::placeholder {
      color: #5a6a8a;
    }
    
    .btn-primary {
      padding: 14px 32px;
      background: linear-gradient(135deg, #e94560, #ff6b6b);
      color: #fff;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(233, 69, 96, 0.4);
    }
    
    .btn-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    
    /* åŠ è½½çŠ¶æ€ */
    .loading {
      text-align: center;
      padding: 60px;
    }
    
    .spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(233, 69, 96, 0.2);
      border-top-color: #e94560;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .loading-text {
      color: #ccd6f6;
      font-size: 16px;
    }
    
    .loading-step {
      color: #8892b0;
      font-size: 14px;
      margin-top: 8px;
    }
    
    /* ç»“æœå±•ç¤º */
    .result-box {
      background: rgba(255,255,255,0.05);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 24px;
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      flex-wrap: wrap;
      gap: 16px;
    }
    
    .stock-info h2 {
      font-size: 24px;
      color: #fff;
      margin-bottom: 4px;
    }
    
    .stock-info .code {
      color: #8892b0;
      font-size: 14px;
    }
    
    .stock-info .code a {
      color: #64b5f6;
      text-decoration: none;
    }
    
    .stock-info .code a:hover {
      text-decoration: underline;
    }
    
    /* æ€»åˆ†å±•ç¤º */
    .total-score {
      text-align: center;
      padding: 30px;
      border-radius: 16px;
      margin-bottom: 24px;
    }
    
    .total-score.positive {
      background: linear-gradient(135deg, rgba(46, 213, 115, 0.2), rgba(46, 213, 115, 0.05));
      border: 2px solid rgba(46, 213, 115, 0.5);
    }
    
    .total-score.neutral {
      background: linear-gradient(135deg, rgba(255, 193, 7, 0.2), rgba(255, 193, 7, 0.05));
      border: 2px solid rgba(255, 193, 7, 0.5);
    }
    
    .total-score.negative {
      background: linear-gradient(135deg, rgba(255, 71, 87, 0.2), rgba(255, 71, 87, 0.05));
      border: 2px solid rgba(255, 71, 87, 0.5);
    }
    
    .score-label {
      color: #8892b0;
      font-size: 14px;
      margin-bottom: 8px;
    }
    
    .score-value {
      font-size: 72px;
      font-weight: 800;
      line-height: 1;
      margin-bottom: 12px;
    }
    
    .total-score.positive .score-value { color: #2ed573; }
    .total-score.neutral .score-value { color: #ffc107; }
    .total-score.negative .score-value { color: #ff4757; }
    
    .rating {
      font-size: 20px;
      font-weight: 600;
    }
    
    .total-score.positive .rating { color: #2ed573; }
    .total-score.neutral .rating { color: #ffc107; }
    .total-score.negative .rating { color: #ff4757; }
    
    /* è¯„åˆ†æ˜ç»† */
    .score-details {
      display: grid;
      gap: 16px;
    }
    
    .score-item {
      background: rgba(0,0,0,0.2);
      border-radius: 12px;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 12px;
    }
    
    .score-item-left {
      flex: 1;
      min-width: 200px;
    }
    
    .score-item-name {
      font-size: 16px;
      font-weight: 600;
      color: #ccd6f6;
      margin-bottom: 4px;
    }
    
    .score-item-detail {
      font-size: 13px;
      color: #8892b0;
    }
    
    .score-item-value {
      font-size: 24px;
      font-weight: 700;
      padding: 8px 16px;
      border-radius: 10px;
      min-width: 70px;
      text-align: center;
    }
    
    .score-item-value.positive {
      background: rgba(46, 213, 115, 0.2);
      color: #2ed573;
    }
    
    .score-item-value.neutral {
      background: rgba(255, 193, 7, 0.2);
      color: #ffc107;
    }
    
    .score-item-value.negative {
      background: rgba(255, 71, 87, 0.2);
      color: #ff4757;
    }
    
    /* ä¿èäººæ ‡ç­¾ */
    .sponsor-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }
    
    .sponsor-tag {
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 500;
    }
    
    .sponsor-tag.top {
      background: rgba(46, 213, 115, 0.2);
      color: #2ed573;
    }
    
    .sponsor-tag.mid {
      background: rgba(255, 193, 7, 0.2);
      color: #ffc107;
    }
    
    .sponsor-tag.low {
      background: rgba(255, 71, 87, 0.2);
      color: #ff4757;
    }
    
    /* é”™è¯¯æç¤º */
    .error-box {
      background: rgba(255, 71, 87, 0.1);
      border: 1px solid rgba(255, 71, 87, 0.3);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
    }
    
    .error-box h3 {
      color: #ff4757;
      margin-bottom: 8px;
    }
    
    .error-box p {
      color: #ccd6f6;
      font-size: 14px;
    }
    
    /* æ‰“åˆ†æ ‡å‡† */
    .criteria-box {
      background: rgba(255,255,255,0.03);
      border-radius: 16px;
      padding: 24px;
      border: 1px solid rgba(255,255,255,0.08);
      margin-top: 24px;
    }
    
    .criteria-box h4 {
      color: #8892b0;
      font-size: 14px;
      margin-bottom: 16px;
    }
    
    .criteria-box ul {
      list-style: none;
      color: #5a6a8a;
      font-size: 12px;
      line-height: 2;
    }
    
    .criteria-box li strong {
      color: #8892b0;
    }
    
    /* é¡µè„š */
    .footer {
      text-align: center;
      margin-top: 40px;
      color: #5a6a8a;
      font-size: 12px;
    }
    
    .footer p {
      margin-bottom: 8px;
    }
    
    /* å“åº”å¼ */
    @media (max-width: 600px) {
      .header h1 {
        font-size: 28px;
      }
      
      .search-form {
        flex-direction: column;
      }
      
      .btn-primary {
        width: 100%;
        justify-content: center;
      }
      
      .score-value {
        font-size: 56px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- æ ‡é¢˜ -->
    <div class="header">
      <h1>ğŸ¯ æ¸¯è‚¡æ–°è‚¡è‡ªåŠ¨æ‰“åˆ†å™¨</h1>
      <p>è¾“å…¥è‚¡ç¥¨ä»£ç  Â· è‡ªåŠ¨ä¸‹è½½æ‹›è‚¡ä¹¦ Â· æ™ºèƒ½åˆ†æè¯„åˆ†</p>
      <span class="badge">âœ¨ å…¨è‡ªåŠ¨ç‰ˆ</span>
    </div>
    
    <!-- æœç´¢æ¡† -->
    <div class="search-box">
      <form class="search-form" onsubmit="handleScore(event)">
        <div class="form-group">
          <label for="stockCode">è‚¡ç¥¨ä»£ç </label>
          <input 
            type="text" 
            id="stockCode" 
            placeholder="ä¾‹å¦‚: 09988 æˆ– 2456"
            required
          >
        </div>
        <button type="submit" class="btn-primary" id="submitBtn">
          <span>ğŸ”</span>
          <span>å¼€å§‹è¯„åˆ†</span>
        </button>
      </form>
      
      <div style="margin-top: 16px; padding: 12px; background: rgba(100, 181, 246, 0.1); border-radius: 10px; border: 1px solid rgba(100, 181, 246, 0.2);">
        <p style="color: #64b5f6; font-size: 13px; margin: 0;">
          ğŸ’¡ <strong>å·¥ä½œåŸç†ï¼š</strong>è‡ªåŠ¨ä»æ¸¯äº¤æ‰€æŠ«éœ²æ˜“æœç´¢å¹¶ä¸‹è½½æ‹›è‚¡ä¹¦PDF â†’ 
          è§£ææå–å…³é”®ä¿¡æ¯ â†’ æŒ‰æ‰“åˆ†è§„åˆ™è®¡ç®—å¾—åˆ†
        </p>
      </div>
    </div>
    
    <!-- ç»“æœåŒºåŸŸ -->
    <div id="resultArea"></div>
    
    <!-- æ‰“åˆ†æ ‡å‡† -->
    <div class="criteria-box">
      <h4>ğŸ“‹ æ‰“åˆ†æ ‡å‡†è¯´æ˜</h4>
      <ul>
        <li>â€¢ <strong>åŸºç¡€åˆ†</strong>: 0åˆ†</li>
        <li>â€¢ <strong>æœ‰æ— æ—§è‚¡</strong>: æœ‰æ—§è‚¡-2åˆ†ï¼Œæ— æ—§è‚¡ä¸åŠ å‡</li>
        <li>â€¢ <strong>ä¿èäºº</strong>: é¦–æ—¥æ¶¨å¹…â‰¥70%åŠ 2åˆ†ï¼Œ40%-70%ä¸åŠ å‡ï¼Œ&lt;40%å‡2åˆ†ï¼ˆä¿è&lt;8åªç»´æŒ0åˆ†ï¼‰</li>
        <li>â€¢ <strong>åŸºçŸ³æŠ•èµ„è€…</strong>: æœ‰æ˜æ˜ŸåŸºçŸ³+2åˆ†ï¼ˆé«˜ç“´/GIC/æ·¡é©¬é”¡/çº¢æ‰ç­‰ï¼‰ï¼Œæ— åŸºçŸ³ä¸åŠ å‡</li>
        <li>â€¢ <strong>IPOå‰æŠ•èµ„è€…</strong>: æ— ç¦å”®æœŸ-2åˆ†ï¼Œæœ‰ç¦å”®æœŸä¸åŠ å‡</li>
        <li>â€¢ <strong>è¡Œä¸š</strong>: ç‰©ä¸šç®¡ç†/è½¯ä»¶æœåŠ¡/åŒ»è¯åŒ»ç–—+2åˆ†ï¼Œçººç»‡/æœè£…/é‡‘èæœåŠ¡-2åˆ†ï¼Œå…¶ä»–ä¸åŠ å‡</li>
        <li>â€¢ <strong>ä¼°å€¼</strong>: å¸‚ç›ˆç‡ä½äºåŒè¡Œ+2åˆ†ï¼Œæ¥è¿‘ä¸åŠ å‡ï¼Œé«˜äº-2åˆ†ï¼ˆéœ€æ‰‹åŠ¨è¡¥å……ï¼‰</li>
      </ul>
    </div>
    
    <!-- é¡µè„š -->
    <div class="footer">
      <p>âš ï¸ æœ¬å·¥å…·ä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚æŠ•èµ„æœ‰é£é™©ï¼Œå…¥å¸‚éœ€è°¨æ…ã€‚</p>
      <p>æ•°æ®æ¥æºï¼šæ¸¯äº¤æ‰€æŠ«éœ²æ˜“ (hkexnews.hk)</p>
    </div>
  </div>
  
  <script>
    // API åŸºç¡€åœ°å€ï¼ˆéƒ¨ç½²æ—¶ä¿®æ”¹ï¼‰
    const API_BASE = '';
    
    // åŠ è½½çŠ¶æ€æ­¥éª¤
    const loadingSteps = [
      'æ­£åœ¨æœç´¢æ‹›è‚¡ä¹¦...',
      'æ­£åœ¨ä¸‹è½½PDFæ–‡ä»¶...',
      'æ­£åœ¨è§£ææ‹›è‚¡ä¹¦å†…å®¹...',
      'æ­£åœ¨åˆ†æè¯„åˆ†é¡¹ç›®...',
      'æ­£åœ¨è®¡ç®—æœ€ç»ˆå¾—åˆ†...',
    ];
    
    let loadingStepIndex = 0;
    let loadingInterval = null;
    
    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    function showLoading() {
      loadingStepIndex = 0;
      const resultArea = document.getElementById('resultArea');
      resultArea.innerHTML = `
        <div class="result-box">
          <div class="loading">
            <div class="spinner"></div>
            <div class="loading-text">æ­£åœ¨è‡ªåŠ¨è¯„åˆ†ä¸­...</div>
            <div class="loading-step" id="loadingStep">${loadingSteps[0]}</div>
          </div>
        </div>
      `;
      
      // æ¨¡æ‹Ÿæ­¥éª¤è¿›åº¦
      loadingInterval = setInterval(() => {
        loadingStepIndex = (loadingStepIndex + 1) % loadingSteps.length;
        const stepEl = document.getElementById('loadingStep');
        if (stepEl) {
          stepEl.textContent = loadingSteps[loadingStepIndex];
        }
      }, 3000);
    }
    
    // åœæ­¢åŠ è½½
    function stopLoading() {
      if (loadingInterval) {
        clearInterval(loadingInterval);
        loadingInterval = null;
      }
    }
    
    // è·å–åˆ†æ•°æ ·å¼ç±»
    function getScoreClass(score) {
      if (score > 0) return 'positive';
      if (score < 0) return 'negative';
      return 'neutral';
    }
    
    // æ ¼å¼åŒ–åˆ†æ•°æ˜¾ç¤º
    function formatScore(score) {
      if (score > 0) return `+${score}`;
      return score.toString();
    }
    
    // è·å–è¯„çº§å›¾æ ‡
    function getRatingIcon(rating) {
      if (rating.includes('å¼ºçƒˆæ¨è')) return 'ğŸ”¥';
      if (rating.includes('å»ºè®®ç”³è´­')) return 'âœ…';
      if (rating.includes('å¯è€ƒè™‘')) return 'ğŸ¤”';
      if (rating.includes('è°¨æ…')) return 'âš ï¸';
      if (rating.includes('ä¸å»ºè®®')) return 'âŒ';
      return 'ğŸš«';
    }
    
    // æ˜¾ç¤ºç»“æœ
    function showResult(data) {
      const resultArea = document.getElementById('resultArea');
      const { stockCode, totalScore, rating, scores, prospectusUrl } = data;
      
      const scoreClass = totalScore >= 4 ? 'positive' : totalScore >= 0 ? 'neutral' : 'negative';
      
      resultArea.innerHTML = `
        <div class="result-box">
          <div class="result-header">
            <div class="stock-info">
              <h2>è‚¡ç¥¨ä»£ç : ${stockCode}</h2>
              <p class="code">
                æ‹›è‚¡ä¹¦: <a href="${prospectusUrl}" target="_blank">æŸ¥çœ‹åŸæ–‡ â†—</a>
              </p>
            </div>
          </div>
          
          <!-- æ€»åˆ† -->
          <div class="total-score ${scoreClass}">
            <div class="score-label">æ€»å¾—åˆ†</div>
            <div class="score-value">${totalScore}</div>
            <div class="rating">${getRatingIcon(rating)} ${rating}</div>
          </div>
          
          <!-- è¯„åˆ†æ˜ç»† -->
          <div class="score-details">
            <!-- æ—§è‚¡ -->
            <div class="score-item">
              <div class="score-item-left">
                <div class="score-item-name">1. æœ‰æ— æ—§è‚¡</div>
                <div class="score-item-detail">${scores.oldShares.detail}</div>
              </div>
              <div class="score-item-value ${getScoreClass(scores.oldShares.score)}">
                ${formatScore(scores.oldShares.score)}
              </div>
            </div>
            
            <!-- ä¿èäºº -->
            <div class="score-item">
              <div class="score-item-left">
                <div class="score-item-name">2. ä¿èäººä¸šç»©</div>
                <div class="score-item-detail">${scores.sponsor.detail}</div>
                ${scores.sponsor.sponsors.length > 0 ? `
                  <div class="sponsor-tags">
                    ${scores.sponsor.sponsors.map(s => `
                      <span class="sponsor-tag ${s.tier}">${s.name} (${s.avgReturn}%)</span>
                    `).join('')}
                  </div>
                ` : ''}
              </div>
              <div class="score-item-value ${getScoreClass(scores.sponsor.score)}">
                ${formatScore(scores.sponsor.score)}
              </div>
            </div>
            
            <!-- åŸºçŸ³æŠ•èµ„è€… -->
            <div class="score-item">
              <div class="score-item-left">
                <div class="score-item-name">3. åŸºçŸ³æŠ•èµ„è€…</div>
                <div class="score-item-detail">${scores.cornerstone.detail}</div>
                ${scores.cornerstone.cornerstones.length > 0 ? `
                  <div class="sponsor-tags">
                    ${scores.cornerstone.cornerstones.slice(0, 5).map(c => `
                      <span class="sponsor-tag top">â­ ${c}</span>
                    `).join('')}
                  </div>
                ` : ''}
              </div>
              <div class="score-item-value ${getScoreClass(scores.cornerstone.score)}">
                ${formatScore(scores.cornerstone.score)}
              </div>
            </div>
            
            <!-- IPOå‰æŠ•èµ„è€… -->
            <div class="score-item">
              <div class="score-item-left">
                <div class="score-item-name">4. IPOå‰æŠ•èµ„è€…</div>
                <div class="score-item-detail">${scores.preIPO.detail}</div>
              </div>
              <div class="score-item-value ${getScoreClass(scores.preIPO.score)}">
                ${formatScore(scores.preIPO.score)}
              </div>
            </div>
            
            <!-- è¡Œä¸š -->
            <div class="score-item">
              <div class="score-item-left">
                <div class="score-item-name">5. è¡Œä¸š</div>
                <div class="score-item-detail">${scores.industry.detail}</div>
              </div>
              <div class="score-item-value ${getScoreClass(scores.industry.score)}">
                ${formatScore(scores.industry.score)}
              </div>
            </div>
            
            <!-- ä¼°å€¼ -->
            <div class="score-item">
              <div class="score-item-left">
                <div class="score-item-name">6. ä¼°å€¼ (å¯é€‰)</div>
                <div class="score-item-detail">${scores.valuation.detail}</div>
              </div>
              <div class="score-item-value ${getScoreClass(scores.valuation.score)}">
                ${formatScore(scores.valuation.score)}
              </div>
            </div>
          </div>
        </div>
      `;
    }
    
    // æ˜¾ç¤ºé”™è¯¯
    function showError(message) {
      const resultArea = document.getElementById('resultArea');
      resultArea.innerHTML = `
        <div class="result-box">
          <div class="error-box">
            <h3>âŒ è¯„åˆ†å¤±è´¥</h3>
            <p>${message}</p>
          </div>
        </div>
      `;
    }
    
    // å¤„ç†è¯„åˆ†è¯·æ±‚
    async function handleScore(event) {
      event.preventDefault();
      
      const stockCode = document.getElementById('stockCode').value.trim();
      if (!stockCode) return;
      
      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = true;
      
      showLoading();
      
      try {
        const response = await fetch(`${API_BASE}/api/score/${stockCode}`);
        const data = await response.json();
        
        stopLoading();
        
        if (data.success) {
          showResult(data);
        } else {
          showError(data.error || 'è¯„åˆ†å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
        }
      } catch (error) {
        stopLoading();
        showError(`è¯·æ±‚å¤±è´¥: ${error.message}`);
      } finally {
        submitBtn.disabled = false;
      }
    }
    
    // æ”¯æŒå›è½¦æäº¤
    document.getElementById('stockCode').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        document.querySelector('.search-form').dispatchEvent(new Event('submit'));
      }
    });
  </script>
</body>
</html>
